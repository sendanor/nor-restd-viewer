(function($,win){var FN={};$.render=function(template,data){return(FN[template]=FN[template]||Function("_","return '"+$.trim(template).replace(/\n/g,"").replace(/\{([^\}]+)\}/g,"'+_.$1+'")+"'"))(data)};$.el=function(template,data){return $($.render(template,data))};$.observable=function(obj){var jq=$({});$.each(["on","one","emit","off"],function(i,name){obj[name]=function(names,fn){if(i<2){jq[name](names,function(e){var args=[].slice.call(arguments,1);if(names.split(" ")[1])args.unshift(e.type);fn.apply(obj,args)})}else if(i==2){jq.trigger(names,[].slice.call(arguments,1))}else{jq.off(names,fn)}return obj}});return obj};win=$(win);var page_popped;win.on("load",function(e){setTimeout(function(){if(!page_popped)win.trigger("popstate")},1)}).on("popstate",function(e){if(!page_popped)page_popped=true});$.route=function(to){if($.isFunction(to)){win.on("popstate",function(e,hash){to(hash||location.hash)})}else if(to!=location.hash){if(history.pushState)history.pushState("","",to);win.trigger("popstate",[to])}}})(jQuery,window);